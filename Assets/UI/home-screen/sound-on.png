dPageType",void 0),u(m(o),"telemetryHandler",void 0),u(m(o),"uxUtils",void 0),u(m(o),"moduleName",re.PRODUCT_SUMMARY),u(m(o),"productSummarySection",void 0),u(m(o),"isDarkMode",!1),u(m(o),"productSummary",void 0),u(m(o),"logMetadata",{}),u(m(o),"sectionId","product-summary-shopping-section"),o.flyoutData=e,o.uxUtils=t,o.utilities=t.viewModulesUtilities,o.telemetryHandler=t.discoverTelemetryHandler,o.pageHandlerModule=t.pageHandlerModule,o.logModule=t.logModule,o.storageHandler=t.storageHandler,o.commonAssets=n,o.stateManagement=i,o.isDarkMode=o.utilities.isDarkMode(),o.assets=new F8,o}return c(s,[{key:"GetModuleName",value:function(){return this.moduleName}},{key:"ShouldRenderModule",value:(o=t(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.GetProductSummary())){e.next=9;break}if(this.stateManagement.AddDiscoverRenderModule(re.PRODUCT_SUMMARY),this.productSummary=t,!v.isExperimentActive(h.discoverShopping)||!this.flyoutData.common.isDiscoverPane){e.next=7;break}return this.logMetadata={isProductSummary:!!t.summary,popularOpinionsCount:t.popularOpinions.length,topInsightsCount:t.topInsights.length},e.abrupt("return",Promise.resolve(!0));case 7:if(!v.isTestFlagActive(f.msShoppingTestExp99)){e.next=9;break}return e.abrupt("return",Promise.resolve(!0));case 9:return e.abrupt("return",Promise.resolve(!1));case 10:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"populateMainHeader",value:function(){var e=this.flyoutData.common.shopping.querySelector("#product-summary-shopping-section");e&&(e.slot="header-content")}},{key:"renderModule",value:(n=t(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.utilities.applyStyles(this.flyoutData.common.shopping,this.assets.getStyles(),void 0,this.assets.getDarkModeStyles()),t=Oi("msft-edge-shopping-section",{id:this.sectionId,titleText:this.flyoutData.strings.psSectionTitle,accordion:this.flyoutData.common.currentDevice===$.Desktop,expanded:!0}),this.CreateUx(t),e.abrupt("return",this.CreateModule(t,te.PRODUCT_SUMMARY,this.moduleName,le.CONTEXTUAL,ce.LIST));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"PostProcessing",value:function(e,t,n){var i="position ".concat(t);0===t&&this.telemetryHandler.LogEventTelemetry(P.ProductSummary,i,this.renderedPageType,e,this.logMetadata)}},{key:"GetProductSummary",value:function(){var e;return null===(e=this.flyoutData.dataStoreModule.DiscoverShoppingData)||void 0===e?void 0:e.ProductSummaryData}},{key:"CreateUx",value:function(e){var t,n,i,r=this,o=Oi("div",{className:this.withClassNamePrefix("container")}),a=Oi("div",{className:this.withClassNamePrefix("card"),title:"product summary"});this.flyoutData.common.isDiscoverPane||(o.classList.add(this.withClassNamePrefix("containerPane")),a.classList.add(this.withClassNamePrefix("cardPane"))),null!==(t=this.productSummary)&&void 0!==t&&null!==(t=t.summary)&&void 0!==t&&t.length&&a.appendChild(this.createProductSummarySection(this.productSummary.summary)),null!==(n=this.productSummary)&&void 0!==n&&null!==(n=n.popularOpinions)&&void 0!==n&&n.length&&a.appendChild(this.createPopularOpinionsSection(this.productSummary.popularOpinions)),null!==(i=this.productSummary)&&void 0!==i&&null!==(i=i.topInsights)&&void 0!==i&&i.length&&a.appendChild(this.createTopInsightsSection(this.productSummary.topInsights,this.productSummary.hasLinks)),o.appendChild(a);o.addEventListener("mouseover",(function e(){var t=V8({productSummaryData:r.productSummary},r.logMetadata);r.telemetryHandler.LogEventTelemetry(P.ProductSummaryHover,"Product Summary Hover",r.renderedPageType,r.moduleName,t),o.removeEventListener("mouseover",e)})),e.appendChild(o)}},{key:"createProductSummarySection",value:function(e){var t=this.flyoutData.strings.psReviewSummary,n=this.assets.getPreviewLinkIcon(),i=Oi("div",{className:this.withClassNamePrefix("section")}),r=this.createSectionTitle(t,n),o=Oi("p",{className:this.withClassNamePrefix("summary")},e);return i.appendChild(r),i.appendChild(o),i}},{key:"createPopularOpinionsSection",value:function(e){var t,n=this.flyoutData.strings.psPopularOpinions,i=this.assets.getReceiptSparklesIcon(),r=Oi("div",{className:this.withClassNamePrefix("section")}),o=this.createSectionTitle(n,i),a=Oi("div",{className:this.withClassNamePrefix("opinions-list")}),s=U8(e);try{for(s.s();!(t=s.n()).done;){var l=t.value,c=Oi("img",{className:this.withClassNamePrefix("opinions-rating-icon")});c.src="".concat(this.flyoutData.common.resourcesEndpoint,"groceriesCashback/userRatings/star-yellow2.png");var u=Oi("span",{className:this.withClassNamePrefix("opinions-rating-val")},l.aggregateRating.toFixed(1)),d=Oi("span",{className:this.withClassNamePrefix("opinions-divider")}," Â· "),p=Oi("span",{className:this.withClassNamePrefix("opinions-name")},l.name),h=Oi("span",{className:this.withClassNamePrefix("opinions-rating-count")},"(".concat(l.aggregateRatingCount,")")),f=Oi("div",{className:this.withClassNamePrefix("opinions-badge")});f.appendChild(c),f.appendChild(u),f.appendChild(d),f.appendChild(p),f.appendChild(h),a.appendChild(f)}}catch(e){s.e(e)}finally{s.f()}return r.appendChild(o),r.appendChild(a),r}},{key:"createTopInsightsSection",value:function(e,t){var n=this.flyoutData.strings.psTopInsights,i=this.assets.getTagSearchIcon(),r=Oi("div",{className:this.withClassNamePrefix("section")}),o=this.createSectionTitle(n,i),a=Oi("div",{className:this.withClassNamePrefix("insights-list")});return this.createInsightsList(a,e,t),r.appendChild(o),r.appendChild(a),r}},{key:"createInsightsList",value:function(e,t,n){for(var i=this,r=n?"button":"p",o=function(){var o=t[a],s=a===t.length-1?o.title:"".concat(o.title,","),l=Oi(r,{className:i.withClassNamePrefix("insights-badge")},s);n&&(l.classList.add("btn"),l.addEventListener("click",(function(){i.pageHandlerModule.QuerySydney(o.title),i.telemetryHandler.LogClickTelemetry(P.ProductSummaryInsightClick,"Insight click",i.renderedPageType,i.moduleName,V8(V8({},i.logMetadata),{},{insightTitle:o.title}))}))),e.appendChild(l)},a=0;a<t.length;a++)o()}},{key:"createSectionTitle",value:function(e,t){var n=Oi("div",{className:this.withClassNamePrefix("section-title-container")}),i=Oi("span",{className:this.withClassNamePrefix("section-title-icon"),innerHTML:t}),r=Oi("h5",{className:this.withClassNamePrefix("section-title")},e);return n.appendChild(i),n.appendChild(r),n}},{key:"withClassNamePrefix",value:function(e){return"product-summary__".concat(e)}}]),s}(RI),z8=W8,K8=function(){function e(){r(this,e)}return c(e,[{key:"getStyles",value:function(){return"\n        .productTrackingContainer {\n            padding: 6px;\n            padding-bottom: 0;\n        }\n        .productTrackingContentContainer {\n            display: flex;\n            align-items: center;\n            margin-bottom: 16px;\n        }\n        .productTrackingTextContainer {\n            flex: 1;\n            padding: 5px 10px 0 15px;\n            text-align: left;\n            align-self: flex-start;\n        }\n        .productTrackingText {\n            font-weight: 600;\n            line-height: 22px;\n        }\n        .productTrackingSubtitle {\n            color: var(--neutral-foreground-hint);\n            padding-right: 10px;\n        }\n        fluent-switch#trackingToggle {\n            --design-unit: 4;\n            --neutral-foreground-rest: #616161;\n        }\n        #trackingToggle::part(switch) {\n            border: 1px solid #616161;\n        }\n        #trackingToggle.checked::part(switch) {\n            border: 1px solid transparent;\n            background: #0F6CBD;\n        }\n        #trackingToggle::part(checked-indicator) {\n            --design-unit: 4;\n            background: #616161;\n            border: 2px solid transparent;\n            top: 2px;\n            left: 2px;\n        }\n        #trackingToggle.checked::part(checked-indicator) {\n            background: #FFFFFF;\n            left: 22px;\n        }\n        .productTrackingContainer hr {\n            border: none;\n            height: 1px;\n            background: #F5F5F5;\n        }\n        .trackedStateIconContainer {\n            position: absolute;\n            display: flex;\n            margin: 3px;\n            justify-content: center;\n            align-items: center;\n            width: 22px;\n            height: 22px;\n            bottom: 0;\n            right: 0;\n            border-radius: 50%;\n            background: var(--accent-fill-hover, #0473CE);\n            box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.08);\n        }\n        .trackedStateIcon {\n            max-width: 20px;\n        }\n        .alertSettingBtn {\n            display: inline-flex;\n            width: 100%;\n            font-weight: 600;\n            margin-bottom: 6px;\n            font-size: 14px;\n            border-color: #D6D6D6;\n        }\n        .trackedProductText {\n            color: var(--accent-fill-rest);\n            font-weight: 400;\n            background: inherit;\n        }\n        .trackedProductText::part(control) {\n            padding-left: 0\n        }\n        #trackingToggle::part(select-indicator) {\n            min-width: unset;\n            width: 10px;\n        }\n        @media (forced-colors: active) {\n            ::part(checked-indicator) {\n                background: fieldtext;\n            }\n        }\n        "}},{key:"getConciseStyles",value:function(){return"\n        fluent-switch#trackingToggle {\n            --design-unit: 4;\n            --neutral-foreground-rest: #616161;\n        }\n        .productTrackingContainer {\n            padding: 2px 6px;\n        }\n        .productTrackingContentContainer {\n            display: flex;\n            align-items: center;\n        }\n        .productTrackingTextContainer {\n            flex: 1;\n            padding: 0 10px 0 12px;\n            text-align: left;\n            align-self: flex-start;\n        }\n        .productTrackingText {\n            font-weight: 600;\n            font-size: 14px;\n            line-height: 20px;\n        }\n        .productTrackingSubtitle {\n            color: var(--neutral-foreground-hint);\n            padding-right: 10px;\n            font-size: 12px;\n            line-height: 16px;\n        }\n        .trackedStateIconContainer {\n            position: static;\n        }\n        #trackingToggle::part(switch) {\n            border: 1px solid var(--neutral-foreground-rest);\n        }\n        #trackingToggle.checked::part(switch) {\n            border: 1px solid transparent;\n            background: #0F6CBD;\n        }\n        #trackingToggle::part(checked-indicator) {\n            --design-unit: 4;\n            background: var(--neutral-foreground-rest);\n            border: 2px solid transparent;\n            top: 2px;\n            left: 2px;\n        }\n        #trackingToggle.checked::part(checked-indicator) {\n            background: #FFFFFF;\n            left: 22px;\n        }\n        .trackedStateIconContainer {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            width: 40px;\n            height: 40px;\n            border-radius: 50%;\n            background: #E0EDFF;\n            box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.08);\n            max-height: 42px;\n        }\n        .alertSettingBtn {\n            display: inline-flex;\n            height: 24px;\n            font-weight: 400;\n            font-size: 14px;\n            line-height: 22px;\n            margin-top: 6px;\n            margin-left: 52px;\n        }\n        .trackedProductText {\n            color: var(--accent-fill-rest);\n            font-weight: 400;\n            background: inherit;\n        }\n        .trackedProductText::part(control) {\n            padding-left: 0\n        }\n        @media (forced-colors: active) {\n            ::part(checked-indicator) {\n                background: fieldtext;\n            }\n        }\n        "}},{key:"getNotificationStyles",value:function(){return"\n        .productTrackingContainer {\n            padding: 0 16px;\n        }\n        .productTrackingContentContainer {\n            margin-bottom: 0px;\n        }\n        .oosNotification .productTrackingContentContainer {\n            font-size: 13px;\n            padding-bottom: 12px;\n        }\n        .productDetailsContainer {\n            display: flex;\n            padding-bottom: 14px;\n        }\n        .productTrackingText {\n            font-weight: 600;\n            font-size: 14px;\n            line-height: 20px;\n        }\n        .productText {\n            flex: 1;\n            text-align: left;\n            font-weight: 600;\n        }\n        .backInStockText {\n            color: #008A21;\n            font-size: 20px;\n            line-height: 24px;\n        }\n        .productTrackingRetailerText {\n            line-height: 24px;\n            font-size: 20px;\n        }\n        .viewItemBtn {\n            width: 100%;\n            font-weight: 600;\n            font-size: 14px;\n        }\n        .trackedProductContainer {\n            display: flex;\n            padding-top: 12px;\n        }\n        .productTrackingInStockContainer {\n            width: 100%;\n            padding: 0 16px;\n        }\n        .inStockTrackedStateIconContainer {\n            position: static;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            width: 36px;\n            height: 36px;\n      