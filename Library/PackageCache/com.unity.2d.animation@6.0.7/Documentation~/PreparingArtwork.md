tion(n){var t;(function(t){var i;(function(i){const f=6,e=5;i.PeopleCard=({hideSearchBox:t})=>{const r=i.useTenantDisplayName(),u=n.msbDsbHost.getLocString("PeopleCardTitle",r),f=i.useRecommendedPeopleAnswer(),e=i.useOrgChartAnswer();return React.createElement("div",{className:"msbdsb-mp-ppl","data-region":"PeopleSection",role:"group","aria-label":u},!t&&React.createElement(i.WorkSearchBox,null),(f||e)&&React.createElement("div",{className:"msbdsb_people_box_content"},React.createElement(i.RecommendedPeople,null),React.createElement(i.OrgChart,null)))};i.SplitPeopleSection=({hidePeopleSearchBox:n})=>{const t=i.useRecommendedPeopleAnswer();return React.createElement(React.Fragment,null,!n&&React.createElement(i.WorkSearchBox,{isIndependent:!0}),t&&React.createElement(i.RecommendedPeopleSection,null),React.createElement(i.OrgChart,{isIndependent:!0}))};i.WorkSearchBox=({isIndependent:n})=>React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"WorkSearchBox"},React.createElement(o,{isIndependent:n}));const o=({isIndependent:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("WorkSearchBox");const{searchBoxInstrumentedItem:f}=i.useMainPageData(),e=i.useDispatchSetWsbRequeryAction(),o=t=>{var i;if((i=t.target)===null||i===void 0?void 0:i.value){const i=n.msbHost.features.isWorkScopeDsbRedirectEnabled()?n.Scope.Work:n.Scope.People;e(t.target.value,i);t.target.value=""}},s=i.useTenantDisplayName(),u=n.msbHost.features.isWorkScopeDsbRedirectEnabled()?n.msbDsbHost.getLocString("WorkSearchPlaceholder"):n.msbDsbHost.getLocString("PeopleSearchPlaceholder",s);return React.createElement(i.WithInstrumentation,{instrumentedItem:f},React.createElement("div",{className:`msb_dsb_people_search ${!!r&&"msb_dsb_independent_searchbox"}`},React.createElement("input",{id:"msbdsb_people_search_box",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:"msb_dsb_search_box",type:"text","aria-label":u,placeholder:u,onClick:t=>{var i;n.Host.setFocusInWebView("MsbDsb");(i=t.currentTarget)===null||i===void 0?void 0:i.focus()},onChange:o}),React.createElement(n.View.Icon,{icon:{content:"&#xE721",type:2}})))};i.RecommendedPeopleSection=()=>{const u=i.useRecommendedPeopleAnswer();if(!u)return null;let t="msbdsb-mp-ppl";const r=n.msbDsbHost.isPeopleExplanationEnabled(),f=r?"PeopleExplanationSectionTitle":"recommendedSectionTitle";r&&(t=t+" msbdsb_people_explanations");const e=n.msbDsbHost.getLocString(f);return React.createElement("div",{role:"heading","aria-labelledBy":"recommended-section",className:t},React.createElement("div",{className:"msbdsb-recommended-section-header",id:"recommended-section"},React.createElement(i.FluentIcon,{icon:"peopleIcon",additionalCssClasses:"recommended-header-icon"}),e),React.createElement(i.RecommendedPeople,null))};i.RecommendedPeople=()=>{const n=i.useRecommendedPeopleAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"RecommendedPeople",answerType:t},React.createElement(s,{people:n}))};const s=({people:r})=>{var l,a;t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("RecommendedPeople");const f=i.useRecommendedPeoplePaginationSetting();if(!r.recommendedPeople||r.recommendedPeople.length==0)return null;let o=0,v=r.recommendedPeople.length,u=1,s=0;if(f){const i=n.config.msbDsbPeopleShufflingEnabled?e:r.recommendedPeople.length,h=(l=f.pageSize)!==null&&l!==void 0?l:(a=n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbRecommendedPeoplePageSize)!==null&&a!==void 0?a:t.RECOMMENDED_PEOPLE_DISPLAY_COUNT;u=Math.floor(i/h)||1;s=f.currentPageIndex%u;o=Math.min(s*f.pageSize,i-1);v=Math.min(o+f.pageSize,i)}const p=r.recommendedPeople.slice(o,v),w=v-o,y=n.msbDsbHost.isPeopleExplanationEnabled(),b=y?"msb_dsb_peoplehero_container":"msb_dsb_recommendedpeople_container";return React.createElement("div",{className:b},React.createElement("div",{className:"msb_dsb_recommendedpeople_upper"},u>1&&React.createElement(i.PaginationFlippersControl,{paginationId:`RecommendedPeople`,numberOfPages:u,currentPageIndex:s}),React.createElement(i.WithInstrumentation,{instrumentedItem:r.instrumentedItem},React.createElement("ul",{tabIndex:-1,className:`msb_dsb_top_collaborators ${t.MDSB_LIST_CONTAINER_CLASS}`},p.map((t,i)=>{const f=n.msbDsbHost.getLocString("RecentContactsAnnouncementFallback",t.fullName),u=`msbdsb-recommended-person-${o+i}`;return React.createElement(React.Fragment,null,y?React.createElement(c,{person:t,personId:u}):React.createElement(h,{person:t,personId:u,traceId:r===null||r===void 0?void 0:r.traceId,accessibilityProps:{ariaLabel:f,ariaSetPosition:i+1,ariaSetSize:w}}))})))),u>1&&React.createElement(i.PaginationDotList,{paginationId:`RecommendedPeople`,numberOfPages:u,currentPageIndex:s}))},h=({person:t,personId:r,traceId:u,accessibilityProps:n})=>{const{firstName:f,lastName:o,fullName:e,referenceId:s}=t;return React.createElement("li",{key:t.uid},React.createElement(i.WsbPeopleRequery,{id:r,query:e,referenceId:s,answerType:"RecommendedPeople",accessibilityProps:n,isTabbable:!0,traceId:u},React.createElement(i.PersonIcon,{additionalCssClass:"msb_dsb_top_people_icon",person:t}),React.createElement("div",{className:"msb_dsb_recommended_name"},React.createElement("p",null,f!==null&&f!==void 0?f:e),React.createElement("p",{className:"msb_dsb_last_name"},o))))},c=({person:n,personId:t})=>{const{fullName:r,rankingExplanation:u}=n;return React.createElement("div",{id:t,className:"msb_dsb_person_explanation_container"},React.createElement("div",{className:"msb_dsb_person_explanation_header"},R