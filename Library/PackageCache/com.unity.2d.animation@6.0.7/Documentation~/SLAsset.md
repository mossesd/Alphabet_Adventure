o?"leftAdjust":"",c?"rightAdjust":""),a=e?i+2:i+1;return React.createElement(u,{id:`${r}-${i}`,key:t.uid,person:t,ariaSetPosition:a,ariaSetSize:b,additionalCssClasses:l})}),v>0&&React.createElement("div",{className:"msb-dsb-persona"},React.createElement("button",{id:`msbdsb-more-${r}-button`,className:"extra-people-container",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,role:"link","aria-label":n.msbDsbHost.getLocString("MoreButtonLabel",v.toString()),"aria-posinset":y+1,"aria-setsize":b,onClick:c},React.createElement("span",{className:"msb-dsb-extra-people-circle"},"+",v))))};i.OrgChart=({isIndependent:n})=>{const t=i.useOrgChartAnswer();return t?React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"MyOrgChart",answerType:"OrgChart"},React.createElement(l,{orgChart:t,isIndependent:n})):null};const l=({orgChart:u,isIndependent:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("OrgChart");const e="MyOrgChart",f=i.useIsElementExpanded(e),s=i.useDispatchSetElementExpansionAction(e),h={type:2,content:f?"&#xE70E":"&#xE70D"},c=()=>s(!f),o=n.msbDsbHost.getLocString("OrgChartTitle"),l=f?"opened":"collapsed";return i.useEffectSkipFirstRender(()=>{n.msbDsbHost.updateInteractionModel()},[f]),React.createElement("div",{className:`msb_dsb_your_organization  ${!!r&&"msb_dsb_independent_orgchart"}`},React.createElement("button",{id:"msbdsb-orgchart-title",className:"msb_dsb_orgchart_title",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,onClick:c,"aria-label":`${o} dropdown ${l}`},React.createElement(n.View.Icon,{additionalCssClass:"msb_dsb_chevron",icon:h}),React.createElement("div",{id:"OrgChartTitle"},o)),f&&React.createElement(a,{orgChart:u}))},a=({orgChart:f})=>{var l,a;const w=i.useDispatchLaunchUriAction(),b=i.useDispatchLaunchProactiveWorkSearchAction(),{hero:s,managers:e,peers:o,directReports:h}=f,v=n.msbDsbHost.getLocString("ManagersOrgName",(l=e===null||e===void 0?void 0:e[0])===null||l===void 0?void 0:l.fullName),k=i.useMsbWorkSearchUrl(n.config,v,"PersonOrgChart",(a=e===null||e===void 0?void 0:e[0])===null||a===void 0?void 0:a.userPrincipalName,n.msbDsbHost.getFormCode()),nt=React.useCallback(()=>{var t;n.config.msbEnableProactiveSearchTransfers?b({query:v,intent:"PersonOrgChart",entityId:(t=e===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.userPrincipalName,formCode:n.msbDsbHost.getFormCode()}):w(k)},[v,k]),y=s===null||s===void 0?void 0:s.fullName,d=i.useMsbWorkSearchUrl(n.config,y,"PersonOrgChart",undefined,n.msbDsbHost.getFormCode()),p=React.useCallback(()=>{n.config.msbEnableProactiveSearchTransfers?b({query:y,intent:"PersonOrgChart",formCode:n.msbDsbHost.getFormCode()}):w(d)},[y,d]),[c,g]=React.useState(o.slice(0,5));i.useEffectSkipFirstRender(()=>{n.msbDsbHost.updateInteractionModel()},[c.length]);const tt=React.useRef(null);React.useEffect(()=>{const n=tt.current,t=new IntersectionObserver(i=>{const u=i[0],r=n.firstElementChild,f=r===null||r===void 0?void 0:r.nextElementSibling;if((u===null||u===void 0?void 0:u.isIntersecting)&&f){const u=n.clientWidth,e=Math.abs(f.getBoundingClientRect().left-r.getBoundingClientRect().left),i=Math.floor(u/e);o.length>i?g(o.slice(0,i-1)):g(o);t.disconnect()}});return n&&t.observe(n),()=>{t.disconnect()}},[o]);const it=o.length-c.length,rt=it>0?c.length+1:c.length;return React.createElement(i.WithInstrumentation,{instrumentedItem:f.instrumentedItem},React.createElement("div",{className:"org-chart-container"},(e===null||e===void 0?void 0:e.length)>0&&React.createElement("div",null,React.createElement("div",{className:"dsb-manager-row"},React.createElement(r,{idPrefix:"msbdsb-orgchart-manager",people:e,numLeftAdjusted:2,numRightAdjusted:1,onSeeMoreClick:p,isTabbable:!0})),React.createElement("svg",{role:"img","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",className:"dsb-orgChartLine dsb-svg"},React.createElement("line",{x1:"50%",y1:"0",x2:"50%",y2:"100%"}))),s&&React.createElement("div",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`${t.MDSB_LIST_CONTAINER_CLASS} dsb-hero-row ${(e===null||e===void 0?void 0:e.length)?"":"dsb-hero-row-no-manager"}`},React.createElement(u,{id:"msbdsb-orgchart-hero",ariaSetPosition:1,ariaSetSize:rt+1,key:s.uid,person:s,additionalCssClasses:"dsb-hero-circle dsb-hero-persona dsb-persona-text leftAdjust"}),o.length>0&&React.createElement("div",{className:`peerPersonaList ${(e===null||e===void 0?void 0:e.length)>0?"":"noManager"}`},React.createElement("div",{className:"ms-search-orgPersonaListLabel ms-search-text-s dsb-label",id:"heroPersonaListHeader",role:"heading"},n.msbDsbHost.getLocString("SharesSameManager")," (",o.length,")"),React.createElement(r,{idPrefix:"msbdsb-orgchart-peer",isHeroRow:!0,people:o,numLeftAdjusted:1,numRightAdjusted:1,onSeeMoreClick:()=>(e===null||e===void 0?void 0:e.length)>0?nt():p()}))),(h===null||h===void 0?void 0:h.length)>0&&React.createElement("div",null,React.createElement("svg",{"aria-hidden":"true",focusable:"false",role:"img",className:"msb-dsb-direct-report-svg",xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},React.createElement("path",{fill:"none",d:"M 16 0 L 16 45 L 60 45"})),React.createElement("div",{className:"msb_dsb_direct_reports"},React.createElement("div",{className:"ms-search-orgPersonaListLabel ms-search-text-s dsb-label",id:"reportsPersonaListHeader",role:"heading"},n.msbDsbHost.getLocString("YourDirects")," (",h.length,")"),React.createElement(r,{idPrefix:"msbdsb-orgchart-report",people:h,numLeftAdjusted:1,numRightAdjusted:1,onSeeMoreClick:p,isTabbable:!0})))))};i.FileSearchSuggestionsCard=()=>{const n=i.useFileSearchSuggestionsAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerType:t,wrappedComponentName:"FileSearchSuggestionsCard"},React.createElement(v,{fileSearchSuggestionsAnswer:n}))};const v=({fileSearchSuggestionsAnswer:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("FileSuggestions");const{fileSearchSuggestions:u,instrumentedItem:f}=r,e=u.map(t=>({title:t.fileName,scope:n.Scope.Work,icon:"searchIcon"})),o=n.msbDsbHost.getLocString("FileSuggestions");return React.createElement(i.SearchSuggestionsCard,{title:o,icon:"folderIcon",sectionId:"FileSearchSuggestions",suggestions:e,instrumentedItem:f,maxRows:n.config.msbDsbFileSearchSuggestionsRows,maxCharLimit:t.FILE_SEARCH_SUGGESTIONS_CHAR_LIMIT,additionalCssClasses:"msbdsb_file_search_suggestions_card"})};i.AcronymsCard=()=>{const n=i.useAcronymsAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerType:t,wrappedComponentName:"AcronymsCard"},React.createElement(y,{acronymsAnswer:n}))};const y=({acronymsAnswer:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("Acronyms");const{acronyms:s,acronymFeaturedSuggestion:h,instrumentedItem:c}=r,e=t=>n.msbDsbHost.getLocString("AcronymsSuggestionsQuery",t.abbreviatedName),u=h,f=s.map(t=>({title:t.abbreviatedName,query:e(t),scope:n.Scope.Work})),l=n.msbDsbHost.getLocString("AcronymsCardTitle"),a=n.msbDsbHost.getLocString("AcronymFeaturedCount",u.numberOfResults.toString()),o=i.useDispatchSetWsbRequeryAction(),v=React.createElement(React.Fragment,null,React.createElement("div",{className:"msbdsb_search_suggestions_acronyms_card_subtitle"},n.msbDsbHost.getLocString("AcronymsCardSubtitle")),f.map((n,t)=>React.createElement(i.SuggestionPill,{searchText:n.title,icon:"searchIcon",id:`msbdsb_search_suggestions_acronyms_${t+1}`,key:n.title,accessibilityProps:{ariaSetPosition:t+2,ariaSetSize:f.length+1},onClick:()=>o(n.query,n.scope)})));return React.createElement(i.WithInstrumentation,{instrumentedItem:c},React.createElement(i.SearchSuggestionsContainer,{title:l,icon:"acronymsIcon",sectionId:"acronyms",additionalCssClasses:"msbdsb_search_suggestions_acronyms_card"},u&&React.createElement("button",{id:`msbdsb_search_suggestions_acronyms_${0}`,className:"msbdsb_search_suggestions_acronyms_card_top",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,"aria-label":`${u.abbreviatedName} ${u.displayName}`,"aria-posinset":1,"aria-setsize":f.length+1,onClick:()=>o(e(u),n.Scope.Work)},React.createElement("div",{className:"msbdsb_search_sugg