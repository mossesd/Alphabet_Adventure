h,k){_.HL.call(this,a,b,c,d,e,f,k);this.yc=h;this.logger=null;this.H={}};_.R(lQg,_.HL);
var mQg=function(a,b){if(a.H[b])throw new _.jf("FileUploadTracker already exists for this request.");var c=new DPg(b);return a.H[b]=c},pQg=function(a,b,c,d,e){var f=b.wk();a.lE(f,5);return a.upload(b,c,d,e).then(function(h){return nQg(a,f,h)},function(h){return oQg(a,f,h)})},qQg=function(a,b){var c,d,e;return _.bi(function(f){return 1==f.H?(c=b.wk(),a.lE(c,5),d=Promise,e=d.all,_.Uh(f,a.retry([c]),2)):f.return(e.call(d,f.O).then(function(h){return nQg(a,c,h[0])},function(h){return oQg(a,c,h)}))})},
nQg=function(a,b,c){if(!b)throw new _.jf("Request Id is required.");if(8===c.Hd())return _.Al();var d=c.getItem();rQg(a,b,d);d=a.yc?a.yc.Eo([_.UI(new _.TI,d.lc()).setItem(d)]):Promise.resolve();return _.Al(d.then(function(){return a.lE(b,6,c)}))},oQg=function(a,b,c){if(b)return a.lE(b,7,void 0,_.hf(c)),_.Al();throw new _.jf("Request Id is required.");};lQg.prototype.lE=function(a,b,c,d){(a=this.H[a])&&a.lE(b,c,d)};lQg.prototype.Dsa=function(a,b){var c=this.ud(a);a=this.H[a];c&&a&&a.Dsa(c,b)};
lQg.prototype.oV=function(){throw new _.jf("Creating bug reports not supported.");};var rQg=function(a,b,c){var d=a.H[b];d&&(d.setItem(c),a.lE(b,8))};lQg.prototype.fE=function(a){delete this.H[a]};var g2=function(a,b,c){var d=this;this.Oa=new _.BYc;this.H=new _.SVc;this.Ab=a=_.BUc(a.clone(),[].concat(_.Me(new Set(_.Pg(a,27).concat(sQg)))));this.Pg=new _.LWc(a);this.La=new _.OWc(a,null,this.Pg);var e=new _.v0c,f=new _.HXc(_.TK(a)?3:1),h=_.jYc(this.Ab,new _.OXc,f,this.H,Promise.resolve(),7);this.ha=jQg(this.Ab,this.Pg,this.Oa,this.H,this.La,f,e,h);e=new _.F0c;this.O=new lQg(a,this.La,this.Oa,this.ha,this.H,e,c,h);var k=_.L(this.Ab,_.lVc,2);this.ka=new _.vL(function(){return new jPg(a,d.H)});
!_.Q(a,99,!1)&&b&&this.ka.get().get();this.Ga=new mPg(this.ha,k,this.H,e);this.V=new IPg(this.ha,k,this.H);this.oa=new _.vL(function(){return new FPg(k,d.Ga,d.ka.get(),h,d.H)});this.Qa=new xPg(k,h,this.H);this.Ca=new PPg(h,this.H);this.Ba=new BPg(this.ha,h);this.wa=_.Q(k,7,!1)?new YPg:null;this.Wa=new _.vL(function(){return new vPg(d.V,d.Ga,d.ka.get(),d.ha,c)});_.ji("drive.DebugUtil.printCseLogs",function(){window.console.log(_.UVc(d.H))});_.lYc(h,106E3)};
g2.prototype.zfa=function(a,b,c,d){var e=this;c=void 0===c?!1:c;d=void 0===d?1:d;var f=(0,_.HK)(a);this.H.info("drive.ds.FileServiceImpl","Encrypted "+(f?"copy":"upload")+" of '"+a.Qf()+"', oidc popup: "+c);var h=a.yda();h||(h=this.O.pV(),a.Fca(h));var k=mQg(this.O,h);tQg(this,a,b,k,c,d).catch(function(l){k.lE(0,void 0,_.hf(l))}).finally(function(){e.O.fE(h)});return k};
var tQg=function(a,b,c,d,e,f){var h,k,l,m,p,r,t,u;return _.bi(function(v){switch(v.H){case 1:return h=(0,_.FK)(b)?b:new _.RI,_.Wh(v,2,3),k=_.Lb(h,26),!k&&c instanceof File&&c.lastModified&&_.F(h,26,c.lastModified),_.Uh(v,GPg(a.oa.get(),h,d,e,f),5);case 5:l=v.O;if(!(0,_.HK)(b)){v.Bd(6);break}gKg(b,_.pg(h,23));if(b.f6()){v.Bd(6);break}return _.Uh(v,wPg(a.V,b.tb(),_.x(b,9)),8);case 8:m=v.O,_.lWc(b,_.pg(m,2));case 6:return p=new kQg(a.oa.get(),l,h,c,d),r=b.getTitle()||"",t=new File([c],r,{type:c.type}),
_.Uh(v,pQg(a.O,b,t,a.oa.get().getMetadata(h.Mi()),p.ha.bind(p)),3);case 3:_.$h(v);a.oa.get().fE(h.Mi());_.ai(v,0);break;case 2:u=_.Zh(v),d.lE(0,void 0,_.hf(u)),v.Bd(3)}})};
g2.prototype.upload=function(a,b){var c=this;this.H.info("drive.ds.FileServiceImpl",((0,_.FK)(a)?"Upload":"Copy")+" of "+a.getTitle());var d=a.yda();d||(d=this.O.pV(),a.Fca(d));var e=mQg(this.O,d),f=null;b&&(f=b instanceof File?b:new File([b],a.getTitle()||""));((0,_.HK)(a)&&!a.f6()?wPg(this.V,a.getId(),_.x(a,9)).then(function(h){_.lWc(a,_.be(h.getMimeType()));pQg(c.O,a,f)}):Promise.resolve(pQg(this.O,a,f))).finally(function(){c.O.fE(d)});return e};
g2.prototype.eic=function(a){var b=this,c=mQg(this.O,a);qQg(this.O,c).finally(function(){return b.O.fE(a)});return c};var uQg=function(a,b){return ePg(a.ka.get().get(),cJg(b),_.lJ(a.Ab).getEmail())};g2.prototype.W=function(){return dPg(_.DXc[void 0])};
g2.prototype.Mhb=function(a,b){b=void 0===b?!1:b;this.H.info("drive.ds.FileServiceImpl","Range download/decrypt of "+a.tb()+"/"+(_.x(a,2)+", range: undefined-undefined, oidc popup: ")+b);var c=this.Ca,d=this.Ba,e=vQg(this,a,b),f=e.then(function(){return _.L(a,T1,5)});b=new ReadableStream({start:function(h){return e.then(function(){var k=new OMg(a,d,f);return RPg(c,a,f).then(function(l){var m=new _.zJ(0,l.W()-1);return SPg(c,a,k,l,m)})}).then(function(k){h.enqueue(k);h.close()})}});return new eQg(b,
f.then(function(h){return _.x(h,4)}))};
var wQg=function(a,b,c){c=void 0===c?!1:c;a.H.info("drive.ds.FileServiceImpl","Streaming download/decrypt of "+b.tb()+"/"+_.x(b,2));c=vQg(a,b,c);var d=c.then(function(){return _.L(b,T1,5)});return c.then(function(){var e=RPg(a.Ca,b,d),f=new OMg(b,a.Ba,d);return Promise.all([d,e]).then(function(h){var k=h[0],l=h[1],m=a.wa.pV();h=l.W();var p=new _.zJ(0,h-1),r=_.Pb(qKg(k),3),t=YOg(_.DXc[r]);return a.wa.start(m,k.Qf(),Math.ceil((p.end-p.start+1)/t),h).then(function(){return UPg(a.Ca,b,f,l,p,t,function(u){var v=
aQg(a.wa,m);v&&v.write(u);return Promise.resolve()}.bind(a),function(){return 1}).then(function(){return Promise.resolve()})})})})};g2.prototype.Plb=function(a){this.H.info("drive.ds.FileServiceImpl","Streaming download of "+a.tb()+"/"+_.x(a,2));var b=this.ha;return new ReadableStream({start:function(c){return new Promise(function(d,e){b.then(function(f){return f.uf(iKg(new _.mK,a))}).then(function(f){c.enqueue(f.H);c.close()}).then(d,e)})},pull:function(){},cancel:function(){}})};
g2.prototype.pQb=function(a,b){var c=this;b=void 0===b?!1:b;this.H.info("drive.ds.FileServiceImpl","Browser download/decrypt of "+a.tb()+"/"+(_.x(a,2)+", oidc popup: ")+b);KPg(this.V,a);var d,e;return(null!=(e=null==(d=this.wa)?void 0:d.Pv())?e:Promise.resolve(!1)).then(function(f){if(f)return wQg(c,a,b);var h=c.Qa,k=vQg(c,a,b);return k.then(function(){var l=k.then(function(){return _.L(a,T1,5)}),m=PMg(c.Ba,iKg(new _.mK,a),l),p=zPg(h,a,l).then(function(r){return APg(h,a,m,r)});return Promise.all([p,
l]).then(function(r){var t=_.n(r);r=t.next().value;t=t.next().value;_.M0.download(new Blob([r]),t.Qf(),_.be(_.x(t,2)))})})})};
var xQg=function(a,b,c,d,e){e=void 0===e?!1:e;a.H.info("drive.ds.FileServiceImpl","Fetch Unwrapped key for item id: "+b+", oidc popup: "+e);d&&JPg(a.V,b,d);b=wPg(a.V,b,c);e=uQg(a,e);return Promise.all([b,e]).then(function(f){f=_.n(f);var h=f.next().value;f=f.next().value