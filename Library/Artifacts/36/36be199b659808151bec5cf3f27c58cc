="InstalledNotActive",e.InstalledActive="InstalledActive"}(n||(n={})),function(e){e.Teams1="Teams1",e.Teams2="Teams2"}(r||(r={})),function(e){e.DownloadedAndInstalled="DownloadedAndInstalled",e.FailedToDownload="FailedToDownload",e.FailedToInstall="FailedToInstall",e.DownloadPageOpened="DownloadPageOpened"}(o||(o={}))},665380:(e,t,i)=>{"use strict";var n,r;i.d(t,{$:()=>n,f:()=>r}),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Unknown="Unknown",e.Resumed="Resumed",e.Suspending="Suspending"}(n||(n={})),function(e){e.Light="Light",e.Dark="Dark",e.Contrast="Contrast",e.OSTheme="OSTheme"}(r||(r={}))},37117:(e,t,i)=>{"use strict";var n;i.d(t,{$:()=>n}),function(e){e.None="none",e.DayStart="dayStart",e.MeetingPrep="meetingPrep",e.MeetingStart="meetingStart",e.MeetingStarted="meetingStarted",e.MeetingEnd="meetingEnd",e.Feedback="feedback",e.InMeetingActionStatusUpdated="inMeetingActionStatusUpdated",e.InMeetingGreeting="inMeetingGreeting",e.InMeetingShareFile="inMeetingShareFile",e.RunningLate="inMeetingRunningLate",e.ReportUsage="reportUsage"}(n||(n={}))},810845:(e,t,i)=>{"use strict";i.d(t,{$:()=>u,A:()=>v});var n=i(486070),r=i(8122),o=i(974509),s=i(844729),a=i(900288),l=i(12043),c=i(905581),d=i(132756);const u=({discover:e,authenticationResources:t,platformService:i,config:o})=>{const a=(0,s.h)(i,o);return{baseUrlPromise:()=>e.regionGtm(n.Pn.middleTier),serviceName:r.EJ.MiddleTier,authResource:t.mtAuthResource,models:{searchUsers:g(a),getUsersFromInstantScd:m(a),getUsersFromSMSThreads:p(a),getUsersFromSearchUsers:h(a),getUsersExternally:y(a)}}},g=e=>Promise.resolve({constructRequest:(t,i,n)=>({url:i,method:"POST",headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json"}),body:t,apiName:n}),allowedResponses:[o.qj.HTTP_2XX],transformResponse:e=>e.body.json().then((e=>e.value))}),m=e=>Promise.resolve({constructRequest:(t,i,n)=>({url:"beta/scd/lookup",method:"POST",body:JSON.stringify({emails:t,phones:i}),headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":n}),apiName:l.l.InstantScdSearchJob.toString()}),allowedResponses:[o.qj.HTTP_2XX],transformResponse:e=>e.body.json().then((e=>e.value))}),h=e=>Promise.resolve({constructRequest:(t,i,n)=>({url:"beta/users/searchUsers",method:"POST",body:JSON.stringify({emails:t,phones:i}),headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":n}),apiName:l.l.SearchUsersJob.toString()}),allowedResponses:[o.qj.HTTP_2XX],transformResponse:e=>v(e)}),p=e=>Promise.resolve({constructRequest:(t,i)=>({url:"beta/users/me/lookup/phones",method:"POST",body:JSON.stringify({phones:t}),headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":i}),apiName:l.l.SMSThreadSearchJob.toString()}),transformResponse:e=>e.body.json().then((e=>e.results))}),v=e=>{const t=[];return e.body.json().then((e=>(Object.keys(e).forEach((i=>{const n=e[i],r=n.status.toLowerCase();if(r!==a.iu.success&&r!==a.iu.notFound){const e=r===a.iu.notAllowed;throw(0,c.Tr)("PeoplePickerEndpoint",d.jK.FailedToFetch,"getUsersFromSearchUsers",void 0,`Error in finding a user with MT response status code ${r}`,void 0,e)}t.push(...n.userProfiles)})),t)))},y=e=>Promise.resolve({constructRequest:(t,i,n,r)=>({url:n=n.replace("{searchQuery}",t),method:"GET",headers:Object.assign(Object.assign({},e),{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":i}),apiName:r}),allowedResponses:[o.qj.HTTP_2XX,o.qb.FORBIDDEN],transformResponse:f()}),f=()=>e=>{const t=e.status===o.qb.FORBIDDEN;if(t)throw(0,c.Tr)("PeoplePickerEndpoint",d.jK.Forbidden,"getUsersExternally",void 0,"403 Error: Search Result is Forbidden",void 0,t);return e.body.json()}},12043:(e,t,i)=>{"use strict";var n,r;i.d(t,{l:()=>n,z:()=>r}),function(e){e.InstantScdSearchJob="instantScdSearch",e.SMSThreadSearchJob="SMSThreadSearch",e.SearchUsersJob="SearchUsers",e.SearchExternalV3Job="SearchExternalV3",e.XTapSearchJob="xTapSearch",e.SearchV2="SearchV2"}(n||(n={})),function(e){e[e.InviterGroupPolicyError=100]="InviterGroupPolicyError",e[e.InviterNotAllowedError=101]="InviterNotAllowedError",e[e.XtapDisabledError=102]="XtapDisabledError"}(r||(r={}))},789949:(e,t,i)=>{"use strict";i.d(t,{Y:()=>c});var n=i(142513),r=i(50805),o=i(974509),s=i(8122),a=i(810845),l=i(400871);const c=(e,t,i)=>{const{enableEndpointsManagerOnPeoplePickerService:n}=t.get(r.J.People);return i&&n?d(i):u(e)},d=e=>e.createApi(a.$),u=e=>({searchUsers:g(e),getUsersFromInstantScd:m(e),getUsersFromSMSThreads:p(e),getUsersFromSearchUsers:h(e),getUsersExternally:v(e)}),g=e=>(t,i,r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return S(e,t,i,"",r,void 0,o.qj.HTTP_2XX)})),m=e=>(t,i,n,r,o)=>{const s=JSON.stringify({emails:t,phones:i});return S(e,s,r,n,o)},h=e=>(t,i,n,r,o)=>{const s=JSON.stringify({emails:t,phones:i});return k(e,s,r,n,o)},p=e=>(t,i,n,r)=>{const o=JSON.stringify({phones:t});return S(e,o,n,i,r)},v=e=>(t,i,r,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){r=r.replace("{searchQuery}",t);const n=yield f(e,r,s,o.qj.HTTP_2XX,i);return y(n)})),y=e=>e.body.json().then((e=>e)).catch((e=>Promise.reject(e))),f=(e,t,i,n,r)=>(0,l.B)(e,n)({url:t,method:"GET",headers:{"content-type":"application/json","x-ms-client-caller":r},serviceName:s.EJ.MiddleTier,apiName:i}),S=(e,t,i,n,r,o={},a)=>(a?(0,l.B)(e,a):e)({url:i,method:"POST",body:t,headers:Object.assign({"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":n},o),serviceName:s.EJ.MiddleTier,apiName:r}).then((e=>e.body.json())).then((e=>e.value)),k=(e,t,i,n,r,o={})=>e({url:i,method:"POST",body:t,headers:Object.assign({"Content-Type":"application/json;charset=UTF-8",Accept:"application/json","x-ms-client-caller":n},o),serviceName:s.EJ.MiddleTier,apiName:r}).then((e=>(0,a.A)(e)))},113851:(e,t,i)=>{"use strict";i.d(t,{h:()=>n});class n{constructor(){}static getInstance(){return this.platformAppConversationService||(this.platformAppConversationService=new n),this.platformAppConversationService}setSubEntityDeepLinkInfo(e){this.deepLink=e}getSubEntityDeepLinkInfo(){return this.deepLink}setClientMessageId(e){this.clientMessageId=e}getClientMessageId(){return this.clientMessageId}}},188143:(e,t,i)=>{"use strict";var n,r,o;i.d(t,{f5:()=>n,Ko:()=>r,r1:()=>o}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(n||(n={})),function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort"}(r||(r={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(o||(o={}))},699532:(e,t,i)=>{"use strict";i.d(t,{K:()=>Se});var n=i(516909),r=i(486070),o=i(8122),s=i(974509),a=i(844729),l=i(299295),c=i(142513),d=i(145279),u=i(223005),g=i(89062),m=i(48824);const h={source:"teamsAndChannels"},p=()=>({authOptions:h,apiName:"canCreateTWT",url:"beta/teams/canCreateTWT",method:"GET"}),v=e=>({authOptions:h,apiName:"createTeam",url:"beta/teams/create",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),y=(e,t)=>({authOptions:h,apiName:"editTeam",url:`beta/teams/${e}`,method:"PATCH",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),f=(e,t,i)=>({apiName:"profilepicture",url:`beta/teams/${e}/profilepicture?threadId=${t}`,method:"POST",body:i,headers:{"content-type":"application/json"}}),S=e=>(0,c.__awaiter)(void 0,void 0,void 0,(function*(){if(e.status===s.qb.OK)return!0;throw new Error(`Request to server failed with ${null==e?void 0:e.status} request url: ${null==e?void 0:e.url}`)})),k=e=>({apiName:"defaultProfilePicture",url:`beta/teams/defaultProfilePicture?displayName=${e}&highResolution=true`,method:"GET",headers:{"content-type":"application/json"}}),w=e=>(0,c.__awaiter)(void 0,void 0,void 0,(function*(){if(e.status===s.qb.OK&&(null==e?void 0:e.body)){const t=yield e.body.blob();return(yield(0,m.n)(t))||""}throw(0,d.T)(u.A.TransformFailed,e)})),b=e=>({authOptions:h,apiName:"findJoinRequests",url:"beta/teams/findJoinRequests",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),C=e=>({authOptions:h,apiName:"getChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,method:"GET",headers:{"content-type":"application/json"}}),_=e=>({apiName:"migrateGroupToTeam",url:`beta/teams/migrateGroup/${encodeURIComponent(e.groupId)}`,body:(0,g.u4)(Object.assign(Object.assign({},e),{teamType:Object.keys(n.C9I).indexOf(e.teamType)})),method:"PUT",headers:{"content-type":"application/json"}}),T=e=>({apiName:"myGroupMemberships",url:`beta/teams/usergroups?teamType=${e}`,method:"GET",headers:{"content-type":"application/json"}}),I=(e,t)=>({authOptions:h,apiName:"createChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,body:JSON.stringify(t),method:"POST",headers:{"content-type":"application/json"}}),j=(e,t)=>({authOptions:h,apiName:"updateChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,body:JSON.stringify(t),method:"PUT",headers:{"content-type":"application/json"}}),N=e=>({authOptions:h,apiName:"removeChannelEmailSettingsRequest",url:`beta/channels/${e}/email`,method:"DELETE",headers:{"content-type":"application/json"}}),E=(e,t)=>({authOptions:h,apiName:"handleBulkJoinRequests",url:`beta/teams/bulkJoinRequestAdminAction?silentAction=${t}`,method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),A=(e,t)=>({authOptions:h,apiName:"handleJoinRequest",url:`beta/teams/joinRequestAdminAction?silentAction=${t}`,method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),x=(e,t,i)=>({authOptions:h,apiName:"leaveChannel",url:`beta/teams/${e}/channels/${t}/members/${i}`,method:"DELETE",headers:{"content-type":"application/json"}}),D=e=>({authOptions:h,apiName:"userGroupSettings",url:"beta/users/groupsSettings",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),M=e=>({authOptions:h,apiName:"groupSettings",url:`beta/teams/${e}/groupSettings`,method:"GET"}),O=e=>({authOptions:h,apiName:"setFavoritedTimeForStaleTeams",url:"beta/users/setFavoriteTime",body:JSON.stringify(e),method:"PUT",headers:{"content-type":"application/json"}}),F=(e,t,i)=>({authOptions:h,apiName:"removePrivateChannelMembership",url:`beta/teams/${e}/channels/${t}/members/${i}`,method:"DELETE",headers:{"content-type":"application/json"}}),R=(e,t)=>({authOptions:h,apiName:"restoreChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}/restore`,method:"PATCH"}),P=(e,t,i)=>({authOptions:h,apiName:"deleteChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}`,method:"DELETE",body:JSON.stringify(i),headers:{"content-type":"application/json"}}),L=e=>({authOptions:h,apiName:"getSensitivityLabels",url:`beta/users/sensitivityLabels?includeUnscopedLabels=${e}`,method:"GET"}),U=()=>({authOptions:h,apiName:"getSensitivityPolicySettings",url:"beta/users/sensitivityPolicySettings",method:"GET"}),B=(e,t)=>({authOptions:h,apiName:"sponsorJoinRequest",url:`beta/teams/sponsorJoinRequest/${e}`,method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),W=e=>e.body.json().then((e=>{var t,i;if(null==e?void 0:e.value)return Object.assign(Object.assign({},e.value),{groupId:null===(i=null===(t=e.value)||void 0===t?void 0:t.siteInfo)||void 0===i?void 0:i.groupId})})).catch((()=>{throw(0,d.T)(u.A.TransformFailed,e)})),$=e=>(0,c.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e.body.json();if(t&&t.joinRequestsPerTeam){const e=t.joinRequestsPerTeam,i=Object.keys(e),n=[];for(const t of i)if(e[t])for(const i of e[t])i.teamId=t,n.push(i);return t.joinRequestsPerTeam=n,t}})),H=e=>({authOptions:h,apiName:"validateTeamName",url:"beta/teams/validateNaming",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),z=e=>({authOptions:h,apiName:"allChannels",url:`beta/teams/${e}/allchannels`,method:"PUT",body:JSON.stringify({Channels:[{Type:"standard",State:["deleted"]},{Type:"private",State:["deleted"]},{Type:"shared",State:["deleted"]}]}),headers:{"content-type":"application/json"}}),q=(e,t)=>({authOptions:h,apiName:"updateTeamMembership",url:`beta/teams/${encodeURIComponent(e)}/members`,method:"PUT",body:JSON.stringify(t),headers:{"content-type":"application/json"}}),V=(e,t,i,n)=>({authOptions:h,apiName:"updateTeamMembership",url:`beta/teams/${e}/members`,method:"PUT",body:JSON.stringify({groupId:t,userMri:i,updateType:n}),headers:{"content-type":"application/json"}}),G=(e,t,i,n)=>({authOptions:h,apiName:"updatePrivateChannelMembership",url:`beta/teams/${e}/channels/${t}/members/${i}`,method:"PATCH",body:JSON.stringify({mri:i,role:n}),headers:{"content-type":"application/json"}}),J=e=>({authOptions:h,apiName:"resetTeamJoinCode",url:`beta/teams/${e}/joinCode`,method:"PUT",headers:{"content-type":"application/json"}}),Q=e=>({authOptions:h,apiName:"removeTeamJoinCode",url:`beta/teams/${e}/joinCode`,method:"DELETE",headers:{"content-type":"application/json"}}),K=e=>({authOptions:h,apiName:"renewTeam",url:`beta/teams/${e}/renew`,method:"POST"}),Y=(e,t)=>({authOptions:h,apiName:"updateTeamDiscoverability",url:`beta/teams/${e}/discoverable`,method:"PUT",body:JSON.stringify(t)}),X=e=>({authOptions:h,apiName:"getRecommendedTeams",url:`beta/teams/suggested?accessType=${e}&enableFallback=true`,method:"GET"}),Z=e=>({authOptions:h,apiName:"joinTeamById",url:`beta/teams/joinRequest/${e}`,method:"POST",headers:{"content-type":"application/json"}}),ee=(e,t,i)=>({authOptions:h,apiName:"searchRecommendedTeams",url:`beta/teams/find?keywords=${encodeURIComponent(t)}&accessType=${e}&enableKeywordSearch=false&top=100&skipToken=${encodeURIComponent(i||"")}`,method:"GET"}),te=e=>({authOptions:h,apiName:"joinTeamWithCode",url:"beta/teams/joinByCode",method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}}),ie=e=>({authOptions:h,apiName:"cancelJoinRequest",url:`beta/teams/cancelJoinRequest/${e}`,method:"POST",headers:{"content-type":"application/json"}}),ne=e=>({authOptions:h,apiName:"deleteTeam",url:`beta/teams/${encodeURIComponent(e)}/delete`,method:"DELETE",headers:{"content-type":"application/json"}}),re=e=>({authOptions:h,apiName:"archiveTeam",url:`beta/teams/${encodeURIComponent(e)}/archive`,method:"POST",headers:{"content-type":"application/json"}}),oe=e=>({authOptions:h,apiName:"unarchiveTeam",url:`beta/teams/${encodeURIComponent(e)}/unarchive`,method:"POST",headers:{"content-type":"application/json"}}),se=(e,t)=>({authOptions:h,apiName:"setChannelShowForMember",url:`beta/teams/${e}/setDefaultChannel`,method:t?"PUT":"DELETE",headers:{"content-type":"application/json"}}),ae=(e,t)=>({authOptions:h,apiName:"createChannel",url:`beta/teams/${e}/channels`,method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),le=e=>(0,c.__awaiter)(void 0,void 0,void 0,(function*(){return e.body.json().then((e=>({id:e.value.objectId}))).catch((()=>{throw(0,d.T)(u.A.TransformFailed,e)}))})),ce=(e,t,i)=>({apiName:"updateChannel",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}`,method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify(i)}),de=(e,t,i,n)=>{const r={users:i,groupId:t},o=n?"?allowBotsInChannel=true":"";return{authOptions:h,method:"PUT",url:`beta/teams/${encodeURIComponent(e)}/bulkUpdateRoledMembers${o}`,body:(0,g.XC)(r),headers:{"content-type":"application/json"}}},ue=(e,t,i)=>{const n={value:i};return{authOptions:h,method:"PUT",url:`beta/teams/${encodeURIComponent(e)}/channels/${encodeURIComponent(t)}/members`,body:(0,g.XC)(n),headers:{"content-type":"application/json"}}},ge=(e,t)=>{const i=t.map((e=>e.mri));return{authOptions:h,method:"POST",url:`beta/teams/sponsorJoinRequest/${encodeURIComponent(e)}`,body:(0,g.XC)(i),headers:{"content-type":"application/json"}}},me=e=>({authOptions:h,apiName:"getTeamInfo",url:`beta/teams/getTeamInfo?groupId=${e}`,method:"GET",headers:{"content-type":"application/json"}}),he=(e,t,i)=>{const n=Object.assign(Object.assign({},i),{userType:"Guest"});return{apiName:"inviteAndAddGuest",url:`beta/teams/${encodeURIComponent(e)}/${t}/inviteAndAddGuest`,method:"PUT",headers:{"content-type":"application/json"},body:(0,g.u4)(n)}},pe=e=>{const{authenticationResources:t,discover:i,platformService:n,config:s}=e,c=(0,a.h)(n,s),d=(0,l.g)(ve,c),u=(0,l.g)(ye,c);return{baseUrlPromise:()=>i.regionGtm(r.Pn.middleTier),serviceName:o.EJ.MiddleTier,authResource:t.mtAuthWithSkypeXTokenResource,models:{canCreateTWT:d(p),createTeam:d(v).withTransform(W),deletedChannels:d(z),editTeam:d(y),changeTeamPicture:d(f).withTransform(S),getDefaultTeamPicture:d(k).withTransform(w),findJoinRequests:d(b).withTransform($),getChannelEmailSettings:u(C),migrateGroupToTeam:d(_),myGroupMemberships:d(T),createChannelEmailSettings:u(I),updateChannelEmailSettings:u(j),removeChannelEmailSettings:u(N),handleBulkJoinRequests:d(E),handleJoinRequest:d(A),leaveChannel:d(x),groupSettings:d(M),myGroupSettings:d(D),removePrivateChannelMembership:d(F),setFavoritedTimeForStaleTeams:d(O),restoreChannel:d(R),deleteChannel:d(P),editChannel:d(ce),sensitivityLabels:d(L),sensitivityPolicySettings:d(U),sponsorJoinRequest:d(B),updatePrivateChannelMembership:d(G),updateTeamMembership:d(V),validateTeamName:d(H),removeTeamMembership:d(q),resetTeamJoinCode:d(J),removeTeamJoinCode:d(Q),renewTeam:d(K),updateTeamDiscoverability:d(Y),getRecommendedTeams:d(X),joinTeamById:d(Z),searchRecommendedTeams:d(ee),joinTeamWithCode:d(te),cancelJoinRequest:d(ie),archiveTeamRequest:d(re),unarchiveTeamRequest:d(oe),deleteTeamRequest:d(ne),leaveTeamRequest:ye(q),setChannelShowForMember:d(se),createChannel:d(ae).withTransform(le),addBulkMembersToTeam:d(de),addBulkMembersToPrivateChannel:d(ue),requestToAddMembersToTeam:d(ge),getTeamByGroupId:d(me),inviteAndAddGuestToTeam:ye(he)}}};function ve(e){return Promise.resolve({constructRequest:e,allowedResponses:[s.qj.HTTP_2XX]})}function ye(e){return Promise.resolve({constructRequest:e,allowedResponses:[s.qj.HTTP_2XX,s.qj.HTTP_4XX]})}var fe=i(500396);class Se{constructor(e){this._transport=e.createApi(pe)}canCreateTWT(){return this._transport.canCreateTWT()}createTeam(e){const t=Object.assign(Object.assign({},e),{accessType:this.convertTeamAccessType(e.accessType)});return this._transport.createTeam(t)}deletedChannels(e){return this._transport.deletedChannels(e)}editTeam(e,t){return this._transport.editTeam(e,t)}changeTeamPicture(e,t,i){return this._transport.changeTeamPicture(e,t,i)}getDefaultTeamPicture(e){return this._transport.getDefaultTeamPicture(e)}findJoinRequests(e){return this._transport.findJoinRequests(e)}getChannelEmailSettings(e){return this._transport.getChannelEmailSettings(e)}createChannelEmailSettings(e,t){return this._transport.createChannelEmailSettings(e,t)}updateChannelEmailSettings(e,t){return this._transport.updateChannelEmailSettings(e,t)}removeChannelEmailSettings(e){return this._transport.removeChannelEmailSettings(e)}handleBulkJoinRequests(e,t){return this._transport.handleBulkJoinRequests(e,t)}handleJoinRequest(e,t){return this._transport.handleJoinRequest(e,t)}leaveChannel(e,t,i){return this._transport.leaveChannel(e,t,i)}setFavoritedTimeForStaleTeams(e){return this._transport.setFavoritedTimeForStaleTeams(e)}removePrivateChannelMembership(e,t,i){return this._transport.removePrivateChannelMembership(e,t,i)}removeTeamMembership(e,t){return this._transport.removeTeamMembership(e,t)}restoreChannel(e,t){return this._transport.restoreChannel(e,t)}deleteChannel(e,t,i){return this._transport.deleteChannel(e,t,i)}myGroupSettings(e){return this._transport.myGroupSettings(e)}groupSettings(e){return this._transport.groupSettings(e)}sensitivityLabels(e=!1){return this._transport.sensitivityLabels(e)}sensitivityPolicySettings(){return this._transport.sensitivityPolicySettings()}sponsorJoinRequest(e,t){return this._transport.sponsorJoinRequest(e,t)}validateTeamName(e){return this._transport.validateTeamName(e)}updateTeamMembership(e,t,i,n){return this._transport.updateTeamMembership(e,t,i,n)}updatePrivateChannelMembership(e,t,i,n){return this._transport.updatePrivateChannelMembership(e,t,i,n)}resetTeamJoinCode(e){return this._transport.resetTeamJoinCode(e)}removeTeamJoinCode(e){return this._transport.removeTeamJoinCode(e)}renewTeam(e){return this._transport.renewTeam(e)}updateTeamDiscoverability(e,t){return this._transport.updateTeamDiscoverability(e,t)}getRecommendedTeams(e){return this._transport.getRecommendedTeams(e)}joinTeamById(e){return this._transport.joinTeamById(e)}searchRecommendedTeams(e,t,i){return this._transport.searchRecommendedTeams(e,t,i)}joinTeamWithCode(e){return this._transport.joinTeamWithCode(e)}cancelJoinRequest(e){return this._transport.cancelJoinRequest(e)}archiveTeamRequest(e){return this._transport.archiveTeamRequest(e)}unarchiveTeamRequest(e){return this._transport.unarchiveTeamRequest(e)}deleteTeamRequest(e){return this._transport.deleteTeamRequest(e)}leaveTeamRequest(e,t){return this._transport.leaveTeamRequest(e,t)}setChannelShowForMember(e,t){return this._transport.setChannelShowForMember(e,t)}myGroupMemberships(e){return this._transport.myGroupMemberships(e)}createChannel(e,t){return this._transport.createChannel(e,t)}editChannel(e,t,i){return this._transport.editChannel(e,t,i)}addBulkMembersToTeam(e,t,i,n){return this._transport.addBulkMembersToTeam(e,t,i,n)}addBulkMembersToPrivateChannel(e,t,i){return this._transport.addBulkMembersToPrivateChannel(e,t,i)}requestToAddMembersToTeam(e,t){return this._transport.requestToAddMembersToTeam(e,t)}migrateGroupToTeam(e){return this._transport.migrateGroupToTeam(e)}getTeamByGroupId(e){return this._transport.getTeamByGroupId(e)}inviteAndAddGuestToTeam(e,t,i){return this._transport.inviteAndAddGuestToTeam(e,t,i)}convertTeamAccessType(e){switch(e){case n.eUH.Public:return fe.eU.Public;default:return fe.eU.Private}}}},706798:(e,t,i)=>{"use strict";i.d(t,{b:()=>a});var n=i(142513);const r="ModuleLoaded",o="Focus Assist not available on module.",s="HostComms is unable to load toast toasts module. Bailing out.";class a{constructor(e,t){this.hostCommunicationService=t,this.logger=e.newLogger("ToastSettingsService","services-io-toast-settings")}getFocusAssistStateAsync(){var e,t,i,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("toasts");if(n){if(n.getFocusAssistStateAsync)return this.logger.log(r),n.getFocusAssistStateAsync();null===(a=(i=this.logger).errorToTelemetry)||void 0===a||a.call(i,o,"toast_service_settings_warn_user_notice")}else null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,s,"toast_service_settings_warn_user_notice")}))}getGlobalNotificationSettingsAsync(e){var t,i,a,l;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("toasts");if(n){if(n.getGlobalNotificationSettingsAsync)return this.logger.log(r),e?n.getGlobalNotificationSettingsAsync(e):n.getGlobalNotificationSettingsAsync();null===(l=(a=this.logger).errorToTelemetry)||void 0===l||l.call(a,o,"toast_service_settings_warn_user_notice")}else null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,s,"toast_service_settings_warn_user_notice")}))}registerForToastDismissed(e){var t,i,r,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("toasts");n?n.registerForToastDismissed?n.registerForToastDismissed(e):null===(a=(r=this.logger).errorToTelemetry)||void 0===a||a.call(r,o,"toast_service_settings_warn_user_notice"):null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,s,"toast_service_settings_warn_user_notice")}))}registerForNotificationModeChanged(e){var t,i,r,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("toasts");n?n.registerForNotificationModeChanged?n.registerForNotificationModeChanged(e):null===(a=(r=this.logger).errorToTelemetry)||void 0===a||a.call(r,o,"toast_service_settings_warn_user_notice"):null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,s,"toast_service_settings_warn_user_notice")}))}registerForFocusSessionChanged(e){var t,i,r,a;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("toasts");n?n.registerForFocusSessionChanged?n.registerForFocusSessionChanged(e):null===(a=(r=this.logger).errorToTelemetry)||void 0===a||a.call(r,o,"toast_service_settings_warn_user_notice"):null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,s,"toast_service_settings_warn_user_notice")}))}}},805012:(e,t,i)=>{"use strict";i.d(t,{B:()=>a});var n=i(992755),r=i(765923);const o="isOptedIntoT2Web",s="web_app_switcher_opt_out_redirection_fail";class a{constructor(e,t,i){this.localStorage=e,this.crossTabsService=i,this.logger=t.newLogger("WebAppSwitcherService","services-io-web-app-switcher"),this.logger.log("WebAppSwitcherService initialized")}optOutOfT2Web(e){var t,i,n,r;this.crossTabsService?(null===(r=(n=this.logger).logNoPii)||void 0===r||r.call(n,"Opting user out of T2"),this.doRedirection(!0,!0,e)):null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"Cross tabs service is undefined",s,void 0,!0)}redirectThisTabToT1(){this.doRedirection(!1,!1)}doRedirection(e,t,i){var n,o,a,l,c;let d;try{d=this.getT1Url(i)}catch(e){return void(null===(o=(n=this.logger).errorToTelemetry)||void 0===o||o.call(n,"Failed to get T1 url",s,void 0,!0))}t&&!this.clearOptInFlag()||(e&&(null===(a=this.crossTabsService)||void 0===a||a.postMessage("T2WebOptOut")),null===(c=(l=this.logger).infoToTelemetry)||void 0===c||c.call(l,"Redirecting to T1 web","web_app_switcher_out_out_redirection_success",{endpointUrl:d},!0),(0,r.J)().location.replace(d))}clearOptInFlag(){var e,t,i,r;return this.localStorage.get(o,n.f.Global)?(this.localStorage.remove(o,n.f.Global),this.localStorage.get(o,n.f.Global)?(null===(r=(i=this.logger).errorToTelemetry)||void 0===r||r.call(i,"Failed to clear opt-in flag",s,void 0,!0),!1):(this.logger.log("isOptedIntoT2Web flag cleared from local storage"),!0)):(null===(t=(e=this.logger).errorToTelemetry)||void 0===t||t.call(e,"Opt-in flag not found",s,void 0,!0),!1)}getT1Url(e){let t;const i=(0,r.J)();if(e){const i=new URL(e),n=i.pathname+i.search+i.hash,r=new URL(i.origin);r.pathname="/_",r.hash=n,t=r}else{const e=new URL(i.location.href);t=new URL(e.origin)}return t.href}}},61754:(e,t,i)=>{"use strict";i.d(t,{Q:()=>n});class n{static get Instance(){return n._instance||(n._instance=new n),n._instance}constructor(){this.outstandingRequests=void 0,this.mostRecentRequest=void 0,this.requestsMapping=void 0,this.decimalPlaces=void 0,this.subscriber=void 0,this.decimalPlaces=3}processRequest(e,t,i){if(!this.subscriber)return;const{requests:n}=this.outstandingRequests;n.has(e)||n.set(e,{requestsByName:new Map});const{requestsByName:r}=n.get(e),o=r.get(t)||0;r.set(t,o+1),this.requestsMapping.set(i,{operationName:t,operationType:e}),this.notify()}processResponse(e,t){if(!this.subscriber||!this.requestsMapping.has(e))return;const{operationName:i,operationType:n}=this.requestsMapping.get(e);if("subscription"===n)return;this.requestsMapping.delete(e);const r=this.outstandingRequests&&this.outstandingRequests.requests;if(r.has(n)){const{requestsByName:e}=r.get(n);let t=e.get(i);1===t?e.delete(i):t>0&&e.set(i,--t)}const o={requestInfo:{operationName:i,operationType:n},responseTime:t&&parseFloat(t.toFixed(this.decimalPlaces))};this.mostRecentRequest=o,this.notify()}subscribe(e){this.subscriber=e,this.outstandingRequests={requests:new Map},this.requestsMapping=new Map}unsubscribe(){this.subscriber=void 0,this.outstandingRequests=void 0,this.requestsMapping=void 0}notify(){this.subscriber.processUpdate(this.outstandingRequests,this.mostRecentRequest)}}n._instance=void 0},299295:(e,t,i)=>{"use strict";i.d(t,{K:()=>a,g:()=>l});var n=i(142513),r=i(584192),o=i(486070),s=i(844729);const a=(e,t,i)=>a=>{const{discover:l,authenticationResources:d,platformService:u,config:g}=a,m=(0,s.h)(u,g),{headers:h}=t,p=(0,n.__rest)(t,["headers"]),v=Object.assign(Object.assign({},m),h);return{baseUrlPromise:()=>l.regionGtm(o.Pn.middleTier),serviceName:e,authResource:d.mtAuthResource,models:i((e=>{const t=Promise.resolve(Object.assign({constructRequest:(0,r.$)(e,v)},p));return c(t)}))}},l=(e,t,i)=>n=>{const o=e((0,r.$)(n,t),i);return c(o)},c=e=>{const t=Object.assign(e,{allow:i=>(e.then((e=>e.allowedResponses=i)),t),withCustomTelemetry:i=>(e.then((e=>e.customTelemetry=i)),t),withRetry:i=>(e.then((e=>e.retryPolicy=i)),t),withResponse:i=>(e.then((e=>e.responseType=i)),t),withTransform:i=>(e.then((e=>e.transformResponse=i)),t)});return t}},145279:(e,t,i)=>{"use strict";function n(e,t,i){const n=new Error(e);return Object.assign(n,{reason:e,serverResponse:t,innerException:i})}i.d(t,{T:()=>n})},584192:(e,t,i)=>{"use strict";function n(e,t){return t?(...i)=>{const n=e(...i);return Object.assign(Object.assign({},n),{headers:Object.assign(Object.assign({},t),n.headers)})}:e}i.d(t,{$:()=>n})},80811:(e,t,i)=>{"use strict";i.d(t,{V:()=>n});const n={type:"safelinks",safelinksAtpMT:{type:"safelinksmt",getUrlReputationRestEndpoint:"beta/atpsafelinks/geturlreputationrest/",getpolicyEndpoint:"beta/atpsafelinks/getpolicy/",RESOURCE_KEY:"https://dataservice.o365filtering.com"},telemetry:{getPolicy:"atp_get_policy",getUrlReputation:"atp_get_url_reputation"},policyKey:"atp-safelinks-policy"}},51986:(e,t,i)=>{"use strict";i.d(t,{c:()=>u});var n=i(142513),r=i(50805),o=i(974509),s=i(8122),a=i(738646),l=i(80811),c=i(400871),d=i(303307);class u{constructor(e,t,i,n,r,o){this.send=e,this.authenticationService=t,this.coreSettings=i,this.scenarioFactory=n,this.localStorage=o,this.handleGetATPAuthToken=()=>this.authenticationService.acquireToken(l.V.safelinksAtpMT.RESOURCE_KEY),this.logger=r.newLogger("AtpSafelinksService","services-utilities-atp-safelinks")}initPolicy(){const e=this.scenarioFactory.newScenario(a.RG.ATPGetPolicyTask);this.getPolicy().then((()=>e.stop())).catch((t=>{const i=`Error getting ATP Safelinks policy: ${t.message||""}`;this.logger.error(i),e.fail({errors:i})}))}getPolicy(){var e;return(0,n.__awaiter)(this,void 0,void 0,(function*(){return null!==(e=this.getPolicyFromLocalStore())&&void 0!==e?e:this.getPolicyFromRemote()}))}getUrlReputationRestMT(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const{enabledATPSafelinks:i}=this.coreSettings.get(r.J.Messaging);if(!i||!this._isAtpSafelinksSubscriptionEnabled())return this.logger.log("enabledATPSafelinks false"),{status:o.qb.OK,url:t};try{const i=yield this.handleGetATPAuthToken(),n=yield this._post(l.V.safelinksAtpMT.getUrlReputationRestEndpoint,this._getRequestBody(t,i),this._getHeaders(e));this.logger.log("getUrlReputationRestMT started");const r=yield n.body.json();return{url:t,status:n.status,data:r&&r.isATPSafelinksEnabled?r:{isATPSafelinksEnabled:!1}}}catch(e){return this.logger.error(`AtpSafelinks MT API failed with Error: ${e&&e.message}`),{url:t,status:-1}}}))}getPolicyFromLocalStore(){let e=null;try{const t=this.localStorage.get(l.V.policyKey);if(t){const i=JSON.parse(t);(0,d.z)(i.cookie,i.webAffinitizedUrl)?e=i:this.logger.error("Invalid policy found from localStorage")}}catch(e){this.logger.error(`Error while getting ATP safelinks policy from localStorage: ${e}`)}return e}getPolicyFromRemote(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){let e=null;const t=this.scenarioFactory.newScenario(a.RG.ATPGetPolicy);try{const i=yield this._get(l.V.safelinksAtpMT.getpolicyEndpoint),n=yield i.body.json();this.localStorage&&this.localStorage.setSafe(l.V.policyKey,JSON.stringify(n));const r=`getPolicy status: ${i.status}`;this.logger.debug(r),t.stop({reason:r}),e=n}catch(e){this.logger.error(`AtpSafelinks GetPolicy API failed with Error: ${e&&e.message}`),t.fail({errors:`${l.V.telemetry.getPolicy}_failed`})}return e}))}_getRequestBody(e,t){return{urlList:[e],atptoken:t}}_getHeaders(e){const t={"content-type":"application/json"};return e&&(this._addHeader(e.user,"X-sourceUser",t),this._addHeader(e.id,"X-sourceId",t),this._addHeader(e.detail,"X-sourceDetail",t)),t}_addHeader(e,t,i){i[t]=e}_post(e,t,i){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(0,c.B)(this.send,o.qb.OK)({url:e,method:"POST",body:JSON.stringify(t),headers:i,serviceName:s.EJ.MiddleTier,apiName:"safelink"})}))}_get(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return(0,c.B)(this.send,o.qb.OK)({url:e,method:"GET",serviceName:s.EJ.MiddleTier,apiName:"safelink"})}))}_isAtpSafelinksSubscriptionEnabled(){const{licenseSettings:e}=this.coreSettings.get(r.J.UserResources);return!(!e||!e.isAtpSafelinksEnabled)}}},804589:(e,t,i)=>{"use strict";i.d(t,{aw:()=>n,ZU:()=>r,Fz:()=>o,l6:()=>s,$N:()=>a